on:
  push:
    branches: [main]
    paths-ignore:
      - '.github/**'
      - 'doc/**'
      - 'media/**'
      - 'package.json'
      - 'CHANGELOG.md'

jobs:
  build:
    name: Build  
    runs-on: ubuntu-latest

    steps:
    - name: Check out PowerApps-Language-Tooling
      uses: actions/checkout@master
      with:
        repository: microsoft/PowerApps-Language-Tooling
        token: ${{ secrets.PERSONAL_GITHUB_TOKEN }}
        path: 'PowerApps-Language-Tooling'

    - name: Check out Self
      uses: actions/checkout@master
      with:
        path: 'src'
        token: ${{ secrets.PERSONAL_GITHUB_TOKEN }}

#   test:
#     name: Test
# #    needs: build
#     strategy:
#       matrix:
#         os: [macos-latest, ubuntu-latest, windows-latest]
#     runs-on: ${{ matrix.os }}
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v2
#       - name: Setup Node.js
#         uses: actions/setup-node@v1
#         with:
#           node-version: 14
#       - name: Install dependencies
#         run: npm install
#       - name: Run headless test
#         uses: GabrielBB/xvfb-action@v1.0
#         with:
#           run: npm test

  # publish:
  #   name: Release and publish
  #   needs: test
  #   runs-on: ubuntu-18.04
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v2
  #     - name: Setup Node.js
  #       uses: actions/setup-node@v1
  #       with:
  #         node-version: 14
  #     - name: Install dependencies
  #       run: npm install
  #     - name: Release
  #       env:
  #         GITHUB_TOKEN: ${{ secrets.PERSONAL_GITHUB_TOKEN }}
  #         NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
  #       run: npx semantic-release
  #     # - name: Vscode release plugin
  #     #   uses: JCofman/vscodeaction@master
  #     #   env:
  #     #     PUBLISHER_TOKEN: ${{ secrets.PUBLISHER_TOKEN }}
  #     #   with:
  #     #     args: publish -p $PUBLISHER_TOKEN 
